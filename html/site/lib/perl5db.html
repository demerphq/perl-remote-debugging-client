<?xml version="1.0" ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<!-- saved from url=(0017)http://localhost/ -->
<script language="JavaScript" src="../../displayToc.js"></script>
<script language="JavaScript" src="../../tocParas.js"></script>
<script language="JavaScript" src="../../tocTab.js"></script>
<link rel="stylesheet" type="text/css" href="../../scineplex.css">
<title>/home/komodo-build/buildbot/ko-linux-x86_64-r/ide-6.1/build/release/dbgp/perl/DBGP/blib/lib/perl5db.pl</title>
<link rel="stylesheet" href="../../Active.css" type="text/css" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:support@ActiveState.com" />
</head>

<body>


<!-- INDEX BEGIN -->
<div name="index">
<script>writelinks('__top__',2);</script>
<h1><a>/home/komodo-build/buildbot/ko-linux-x86_64-r/ide-6.1/build/release/dbgp/perl/DBGP/blib/lib/perl5db.pl</a></h1>
<p><a name="__index__"></a></p>


<ul>

	<ul>

		<li><a href="#remote_debugging">REMOTE DEBUGGING</a></li>
		<li><a href="#flags__flags__flags">FLAGS, FLAGS, FLAGS</a></li>
		<ul>

			<ul>

				<li><a href="#_signal"><code>$signal</code></a></li>
				<li><a href="#_single"><code>$single</code></a></li>
				<li><a href="#_saved"><code>@saved</code></a></li>
				<li><a href="#_stack"><code>@stack</code></a></li>
				<li><a href="#_dbline"><code>%dbline</code></a></li>
			</ul>

		</ul>

	</ul>

	<li><a href="#debugger_initialization">DEBUGGER INITIALIZATION</a></li>
	<li><a href="#debugger_initialization">DEBUGGER INITIALIZATION</a></li>
	<ul>

		<li><a href="#basic_setup">BASIC SETUP</a></li>
	</ul>

	<li><a href="#debugger_settings">DEBUGGER SETTINGS</a></li>
	<li><a href="#stopreasons">StopReasons</a></li>
	<li><a href="#notyet">notyet</a></li>
	<li><a href="#findandaddfunctionbreakpoints">findAndAddFunctionBreakPoints</a></li>
	<ul>

		<li><a href="#parse_options"><code>parse_options</code></a></li>
	</ul>

	<li><a href="#db__fake"><code>DB::fake</code></a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<h2><a name="remote_debugging">REMOTE DEBUGGING</a></h2>
<p>Copy the following files from a Komodo installation to
the target system</p>
<pre>
    &lt;Komodo InstallDir&gt;/perllib/* &lt;TargetDir&gt;</pre>
<p>Set the following shell variables.  On Windows use <code>set</code>
instead of <code>export</code>, use double-quoting instead of
single-quoting, and use backslashes instead of forward-slashes.</p>
<pre>
    <span class="variable">export</span> <span class="variable">PERLDB_OPTS</span><span class="operator">=</span><span class="variable">RemotePort</span><span class="operator">=</span><span class="variable">hostname</span><span class="operator">:</span><span class="variable">port</span>
    <span class="variable">export</span> <span class="variable">PERL5DB</span><span class="operator">=</span><span class="string">'BEGIN { require q(&lt;TargetDir&gt;/perl5db.pl) }'</span>
    <span class="variable">export</span> <span class="variable">PERL5LIB</span><span class="operator">=&lt;</span><span class="variable">TargetDir</span><span class="operator">&gt;</span>
    <span class="variable">export</span> <span class="variable">DBGP_IDEKEY</span><span class="operator">=</span><span class="string">"username"</span>
</pre>
<p>
</p>
<h2><a name="flags__flags__flags">FLAGS, FLAGS, FLAGS</a></h2>
<p>There is a certain C programming legacy in the debugger. Some variables,
such as <code>$single</code>, <code>$trace</code>, and <code>$frame</code>, have &quot;magical&quot; values composed
of 1, 2, 4, etc. (powers of 2) OR'ed together. This allows several pieces
of state to be stored independently in a single scalar.</p>
<p>
</p>
<h4><a name="_signal"><code>$signal</code></a></h4>
<p>Used to track whether or not an <code>INT</code> signal has been detected. <code>DB::DB()</code>,
which is called before every statement, checks this and puts the user into
command mode if it finds <code>$signal</code> set to a true value.</p>
<p>
</p>
<h4><a name="_single"><code>$single</code></a></h4>
<p>Controls behavior during single-stepping. Stacked in <code>@stack</code> on entry to
each subroutine; popped again at the end of each subroutine.</p>
<ul>
<li><strong><a name="0_run_continuously" class="item">0 - run continuously.</a></strong>

</li>
<li><strong><a name="1_single_step_go_into_subs_the_s_command" class="item">1 - single-step, go into subs. The 's' command.</a></strong>

</li>
<li><strong><a name="2_single_step_don_t_go_into_subs_the_n_command" class="item">2 - single-step, don't go into subs. The 'n' command.</a></strong>

</li>
<li><strong><a name="depth" class="item">4 - print current sub depth (turned on to force this when &quot;too much
recursion&quot; occurs.</a></strong>

</li>
</ul>
<p>
</p>
<h4><a name="_saved"><code>@saved</code></a></h4>
<p>Saves important globals (<a href="../../lib/pod/perlvar.html#__"><code>$@</code></a>, <a href="../../lib/pod/perlvar.html#__"><code>$!</code></a>, <a href="../../lib/pod/perlvar.html#__e"><code>$^E</code></a>, <a href="../../lib/pod/perlvar.html#__"><code>$,</code></a>, <a href="../../lib/pod/perlvar.html#__"><code>$/</code></a>, <a href="../../lib/pod/perlvar.html#__"><code>$\</code></a>, <a href="../../lib/pod/perlvar.html#__w"><code>$^W</code></a>)
so that the debugger can substitute safe values while it's running, and
restore them when it returns control.</p>
<p>
</p>
<h4><a name="_stack"><code>@stack</code></a></h4>
<p>Saves the current value of <code>$single</code> on entry to a subroutine.
Manipulated by the <a href="../../lib/pod/perlrun.html#c"><code>c</code></a> command to turn off tracing in all subs above the
current one.</p>
<p>
</p>
<h4><a name="_dbline"><code>%dbline</code></a></h4>
<p>Keys are line numbers, values are &quot;condition\0action&quot;. If used in numeric
context, values are 0 if not breakable, 1 if breakable, no matter what is
in the actual hash entry.</p>
<p>
</p>
<hr />
<h1><a name="debugger_initialization">DEBUGGER INITIALIZATION</a></h1>
<p>The debugger\'s initialization actually jumps all over the place inside this
package. This is because there are several BEGIN blocks (which of course 
execute immediately) spread through the code. Why is that?</p>
<p>The debugger needs to be able to change some things and set some things up 
before the debugger code is compiled; most notably, the <code>$deep</code> variable that
<code>DB::sub</code> uses to tell when a program has recursed deeply. In addition, the
debugger has to turn off warnings while the debugger code is compiled, but then
restore them to their original setting before the program being debugged begins
executing.</p>
<p>The first <code>BEGIN</code> block simply turns off warnings by saving the current
setting of <a href="../../lib/pod/perlvar.html#__w"><code>$^W</code></a> and then setting it to zero. The second one initializes
the debugger variables that are needed before the debugger begins executing.
The third one puts <a href="../../lib/pod/perlvar.html#__x"><code>$^X</code></a> back to its former value.</p>
<p>We'll detail the second <code>BEGIN</code> block later; just remember that if you need
to initialize something before the debugger starts really executing, that's
where it has to go.</p>
<p>
</p>
<hr />
<h1><a name="debugger_initialization">DEBUGGER INITIALIZATION</a></h1>
<p>The debugger starts up in phases.</p>
<p>
</p>
<h2><a name="basic_setup">BASIC SETUP</a></h2>
<p>First, it initializes the environment it wants to run in: turning off
warnings during its own compilation, defining variables which it will need
to avoid warnings later, setting itself up to not exit when the program
terminates, and defaulting to printing return values for the <a href="../../lib/pod/perlguts.html#r"><code>r</code></a> command.</p>
<p>
</p>
<hr />
<h1><a name="debugger_settings">DEBUGGER SETTINGS</a></h1>
<p>Keep track of the various settings in this hash</p>
<p>
</p>
<hr />
<h1><a name="stopreasons">StopReasons</a></h1>
<p>Why we are stopping</p>
<ul>
<li><strong><a name="0_started_program" class="item">0 - started program</a></strong>

</li>
<li><strong><a name="1_user_did_a_step_into" class="item">1 - user did a step_into</a></strong>

</li>
<li><strong><a name="2_user_did_a_step_over" class="item">2 - user did a step_over</a></strong>

</li>
<li><strong><a name="4_user_did_a_step_out" class="item">4 - user did a step_out</a></strong>

</li>
<li><strong><a name="8_program_hit_max_recursion_depth" class="item">8 - program hit max-recursion depth</a></strong>

</li>
</ul>
<p>
</p>
<hr />
<h1><a name="notyet">notyet</a></h1>
<p>sub hook_file_spec_win32_fixes() {
    # There's a serious bug in 5.005's win32.pm, so supply fixes
    # from our own space.
    require DB::File::Spec::Win32;
    no strict 'refs';
    foreach $meth (qw(rel2abs splitpath)) {
	*{'File::Spec::Functions::' . $meth} = *{'DB::File::Spec::Win32::' . $meth};
	*{'File::Spec::' . $meth} = *{'DB::File::Spec::Win32::' . $meth};
	*{'File::Spec::Win32::' . $meth} = *{'DB::File::Spec::Win32::' . $meth};
	*{$meth} = *{'DB::File::Spec::Win32::' . $meth};
    }
}</p>
<p>
</p>
<hr />
<h1><a name="findandaddfunctionbreakpoints">findAndAddFunctionBreakPoints</a></h1>
<p>Four ways to break on a sub:</p>
<p>1. No file or line # given: break at the start (or end) of all instances
   of all loaded subs with the given name</p>
<p>2. File given, no line #: break at the start (or end) of all instances
   ot the named function in the given file</p>
<p>3. File and line # given: use the line # to identify which instance of
   a function that matches the given name.  This is to allow for a
   file that contains multiple packages, with the same function name
   in more than one package.</p>
<p>4. No file given, but line # given: This is weird, but we have a
   story:
   Find all instances of the given function, and accept only if the
   given line # falls in the function's range.</p>
<p>
</p>
<h2><a name="parse_options"><code>parse_options</code></a></h2>
<p>Trimmed down version for processing only RemotePort=\d+</p>
<p>
</p>
<hr />
<h1><a name="db__fake"><code>DB::fake</code></a></h1>
<p>Contains the <code>at_exit</code> routine that the debugger uses to issue the
<code>Debugged program terminated ...</code> message after the program completes. See
the <code>END</code> block documentation for more details.</p>

</body>

</html>
